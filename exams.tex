\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fancyhdr}
\usepackage{tikz}

%% == Commands ================================================
\newcommand{\coursecode}{TDA297}
\newcommand{\coursename}{Distributed Systems II (Advanced)}
\newcommand{\authorname}{Sebastian Weddmark Olsson}
\newcommand{\authormail}{sebastiw@student.chalmers.se}
\newcommand{\doctitle}{Tentalösningar}
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height
\newcommand{\oklarhet}[1]{%
  \noindent\fbox{\parbox[b][4em][t]{\textwidth}{\color{red}#1} }%
}
\newcommand{\points}[1]{\subsection{} \textit{#1 points}\\}
\newcommand{\question}[2][]{
  \noindent
  \parbox[t]{\textwidth}{#1 \parbox[t]{0.95\textwidth}{#2}}\\
}

%% == Settings ================================================
\setlength{\topskip}{0pt} % Skip some whitespace at the top
\pagestyle{fancy}
\topmargin -20.0pt
\headheight 56.0pt
\rhead{
  \coursename\\
  \doctitle
}

\tikzset{
  block/.style = {draw, fill=white, rectangle, minimum height=3em, minimum width=3em},
  tmp/.style = {coordinate},
  sum/.style= {draw, fill=white, circle, node distance=1cm},
  input/.style = {coordinate},
  output/.style= {coordinate},
  pinstyle/.style = {pin edge={to-,thin,black}}
}

%% == Document ================================================
\begin{document}


\thispagestyle{plain} % No header for first page
\begin{center}
\horrule{0.5pt} \\[0.3cm] % Thin top horizontal rule
%
\huge \coursecode -- \coursename \\[1mm]
\Large \doctitle \\
\normalsize % Revert to normal sized font
\horrule{2pt} \\[0.1cm] % Thick bottom horizontal rule
\begin{tabular}{ l r }
Av \authorname & \authormail
\end{tabular}\\[0.1cm]
\footnotesize \today\\[0.4cm]
\end{center}
{\footnotesize
Please feel free to spread the document to anyone that wants it, and please improve the solutions if you can. All of the document, as well as the \LaTeX{} code, is public domain.
Note! These solutions are not from the department giving the course, and they have not been checked for errors. The answers might not be explicit enough to give full points.\\
}
\horrule{0.5pt} % Thin top horizontal rule
\normalsize % Revert to normal sized font
\\[2.5cm]

%% == Solutions ================================================
\section{Tenta 2012-03-05}

\points{10}
\question{Give an example of an execution that is sequential
  consistent but not linearizable. \\ Show that every linearizable
  history is sequential consistent.}

\points{10}
\question{Give a specification of a state machine replication
  abstraction and an underlying algorithm to implement it using a
  total order broadcast abstraction.}

\points{5}
\question{Is it possible to implement a total order broadcast
  deterministically in asynchronous systems with message loses? \\
  Provide an algorithm or an impossibility proof.}

\points{10}
\question{What are the properties that a causal broadcast must
  satisfy? \\ Compare the causal broadcast property with the following
property: ``if a process delivers messages $m_1$ and $m_2$, and $m_1
\rightarrow m_2$, then the process must deliver $m_1$ before $m_2$.''}

\points{10}
\question{The flooding algorithm is a straight forward broadcasting
  algorithm. The initiator sends to all its neighbors a message of
  kind broadcast. When a process receives message broadcast for the
  first time, it sends to all other adjacent processes further
  broadcast messages. \\ What is the Time and Message Complexity of
  the algorithm? Please provide a complexity analysis.}

\points{10}
\question{The algorithm by Choy and Singh uses two Doorways. The
  Asynchronous and the Synchronous Doorway. \\ Describe them in
  pseudo-code and informally. \\ Use both Doorways to construct a
  solution to the Dinning Philosophers problem for a system of 3
  philosophers.}

\points{5}
\question{Show that Byzantine agreement can be reached for three
  generals, if the generals digitally sign their messages.}

\section{??}
\points{10}
\question{Construct a solution to reliable, totally ordered multicast
  in a synchronous system, using a reliable multicast and a solution
  to the consensus problem.}

\points{5}
\question[a)]{Can Byzantine agreement be reached for 8 generals, with 3 of
  them faulty?}
\question[b)]{Can Byzantine agreement be reached for 8 generals, with 3 of
  them faulty, if the generals digitally sign their messages?}

\points{8}
\question{A thee-phase commit protocol has the following parts \\
  \textbf{Phase 1:} is the same as the two phase commit.\\
  \textbf{Phase 2:} the coordinator collects the votes and makes a
  decision; if it is No, it aborts and informs participants hat voted
  Yes, if the decision is Yes, it sends a precommit request to all
  participants. Participants that voted Yes wait for a precommit or
  doAbort request. They acknowledge precommit requests and carry out
  doAbort requests. \\
  \textbf{Phase 3:} the coordinator collects the acknowledgements When
  all are received, it commits and sends a do commit to the
  participants. Participants wait for a doCommit request. When it
  arrives they Commit. \\
  Explain how this protocol avoids delay to participants during their
  ``uncertain'' period due to the failure of the coordinator or other
  participants. Assume that communication does not fail.}

\points{10}
\question{A processor P is part of a network G(V,E). P believes that
  processor Q is also connected to the network. Describe a protocol
  that P together with the other processors of the network can use in
  order to find Q or to find that Q is not part of the network. Prove
  the time complexity of the algorithm.}

\points{15}
\question{Give a solution to the dinning philosophers problem. Prove
  the time complexity of the algorithm.}

\points{12}
\question{A quorum consensus method with three replicas is used for
  replication. The parameters of the replication system are described
  in the following table. Calculate: \textit{i)} the read latency,
  \textit{ii)} the write latency, \textit{iii)} the blocking
  probability of a read and \textit{iv)} the blocking probability of a
  write.}

\section{Tenta 2014-03-12}
\points{10}
\question[a)]{Give the definitions of Linearizability and Sequential
  Consistency.}
\question[b)]{A correctness property $\rho$ is compositional if, whenever
  each object in the system satisfies $\rho$, the system as a whole
  satisfies $rho$. Is Sequential Consistency compositional? \\
  If yes explain why, if no give an example.}

\points{10}
\question{Describe the differences between the three-phase commit
  protocol and the two-phase commit protocol. Draw the three-phase
  commit protocol as a state machine where you also describe the
  behavior of the protocol when time-outs are triggered and processes
  are recovered after crashing.}

\points{5}
\question{What are the properties that a causal broadcast must
  satisfy? \\ Compare the causal broadcast property with the following
property: ``if a process delivers messages $m_1$ and $m_2$, and $m_1
\rightarrow m_2$, then the process must deliver $m_1$ before $m_2$.''}

\points{10}
\question[a)]{Describe an algorithm for leader election on a ring
  topology. All processes have unique ids and the system is
  asynchronous. Any process can initiate the leader election protocol
  at any time.}
\question[b)]{Compute the time complexity and communication complexity of
  your algorithm.}
\question[c)]{Is it possible to design a symmetric algorithm for leader
  election? If yes, provide such an algorithm, if no provide a proof.}

\points{15}
\question[a)]{Eric wants to build a replicated storage system. In his
  system there is only one client. The client performs just one
  storage operation (read or write) at a time, waiting for each
  operation to complete before starting the next. Eric wants
  availability even in the case of one server failure. Because of that
  he decides to store the data on two servers. Eric wants to ensure
  that the data on the two servers stay identical all the time. In
  order to guarantee that he is thinking making the two servers atomic
  using three-phase commit, to ensure both-or-nothing behavior. In the
  design he has in mind, the client acts as the transaction
  coordinator. The client would execute a write as described in the
  three-phase commit protocol. The system uses timeout recovery scheme
  explaineed in the lectures. Eric thinks about this design for a
  while, and eventually realizes that three-phase commit is
  fundamentally not suited to providing availability via
  replication. \\
  Please explain why. Eric wants to formalize the consistency
  properties of the replication system. Is it sequential consistent?
  Is it a linearizable one? Please explain your answer.}
\question[b)]{Eric decides to change his design and uses now the gossip
  architecture that lazily synchronizes the two servers. The single
  client contacts any server that is available and gets the value that
  this server has, updates are also performed on the first available
  server first and then lazily propagated on the next server. Each
  client request uses a unique id.\\
  What is the availability that he can achieve? Eric wants to
  formalize the consistency properties of the replication system in
  case where there are no failures. Is it sequential consistent? Is it
  a linearizable one? Please explain your answer.}
\question[c)]{Eric decides to change his design and uses now nine replicas
  and quorums to ensure strong consistency and availability. What are
  the constraints on the sizes of read and write quorums? What is the
  availability that he can achieve? Give an example of quorum
  processing involving a write, two reads, then a write. Eric wants
  to formalize the consistency properties of the replication
  system. Is it sequential consistent? Is it a linearizable one?
  Please explain why?}

\points{10}
\question{The algorithm by Choy and Singh uses two Doorways. The
  Asynchronous and the Synchronous Doorway. \\ Describe them in
  pseudo-code and informally. \\
  If we use the Asynchronous Doorway together with coloring, is this
  algorithm going to give us a solution to the resource allocation
  problem (e.g. is it going to guarantee mutual exclusion and
  no-starvation)? Please provide a proof sketch or a
  counterexample. \\
  What is the time complexity of this algorithm?}

\section{Tenta 2013-03-16}
\points{10}
\question[a)]{Give the definitions of Linearizability and Sequential
  Consistency}
\question[b)]{Give an example pseudocode for a simple program that
  would operate correctly with sequential consistency but incorrectly
  with linearizability. (Briefly explain your answer.)}
\question[c)]{Describe the advantages and disadvantages of using each
  for an application, paying particular attention to any assumptions
  you must make about the users behaviour. As two example applications
  you can consider:
  \begin{itemize}
    \item a web site allowing registered users to upload videos and
      allowing anybody to download and watch them. (Comments on videos
      are note supported.)
    \item a multi-user game, the players move figures around a common
      scene. The state of the game is replicated at the players'
      workstation and a server. The figures may throw projectiles at
      another, and a hit debilitates the unfortunate recipient for a
      limited time. (Application II is from Chapter 18th of the course
      book.)
  \end{itemize}}

\points{10}
\question[a)]{What are FIFO ordering, causal ordering and total
  ordering guarantees of replica managers? How are they related to
  each other?}
\question[b)]{Compare the causal ordering property with the following
property: ``if a replica manager processes messages $m_1$ and $m_2$,
and $m_1 \rightarrow m_2$, then the replica manager must process $m_1$
before $m_2$.''}

\points{10}
\question[a)]{Eric wants to build a replicated storage system. In his
  system there is only one client. The client performs just one
  storage operation (read or write) at a time, waiting for each
  operation to complete before starting the next. Eric wants
  availability even in the case of one server failure. Because of that
  he decides to store the data on two servers. Eric wants to ensure
  that the data on the two servers stay identical all the time. In
  order to guarantee that he is thinking making the two servers atomic
  using two-phase commit, to ensure both-or-nothing behavior. In the
  design he has in mind, the client acts as the transaction
  coordinator. The client would execute a write as described in the
  two-phase commit protocol. The system uses timeout recovery scheme
  explaineed in the lectures. Eric thinks about this design for a
  while, and eventually realizes that two-phase commit is
  fundamentally not suited to providing availability via
  replication. \\
  Please explain why.}
\question[b)]{Eric decides to change his design and use nine replicas
  and quorums to ensure strong consistency and availability. What are
  the constraints on the sizes of read and write quorums? What is the
  availability that he can achieve? Give an example of quorum
  processing involving a write, two reads, then a write.}


\points{10}
\question{A distributed conference application provides a shared
  whiteboard. Each member of the conference has a replica of the
  whiteboard that is managed by a specific member of a closed process
  group. \\
  Describe an approach that uses the algorithm by Choy and Singh to
  achieve mutually exclusive access to the whiteboard, prior to
  propagation of the updates to the whole group. \\
  If the number of members of the group is $n$, what is the time
  complexity of the scheme, provide a brief proof?}

\points{5}
\question{Describe an algorithm that solves consensus in a synchronous
  system where up to $f$ of the $n$ processes exhibit crash failures,
  assume the existence of a reliable multicast protocol. \\
  What is the time complexity of the algorithm.}

\points{10}
\question{The flooding algorithm is a straight forward reliable
  broadcast algorithm. The initiator sends to all its neigbors a
  message of kind broadcast. When a process receives message broadcast
  for the first time, it sends to all other adjacent processes
  further broadcast messages.}
\question[a)]{What are the properties of reliable broadcast.}
\question[b)]{What is the Time and Message Complexity of the algorithm
  in fault-free asynchronous execution?}
\question[c)]{What is the Time and Message Complexity of the algorithm
  in an asynchronous execution in the presence of crash faults? (No
  partitions.) \\
  Please provide brief complexity analysis.}

\points{5}
\question{Consider it as given that there is no Byzantine agreement
  protocol for a system with 3 processes, from which 1 of them
  faulty. Using this proof prove that there is no Byzantine agreement
  protocol for a system with $n \geq 3$ processes, from which $f$ are
  faulty if $n \leq 3f$.}


\section{2013-08-23}
\points{10}
\question{Describe an implementation of a distributed Linked-List that tolerates 2 replica crashes for all operations (\textit{insert, delete} and \textit{find}). Your implementation should take care and clean unnecessary memory periodically.}

\points{10}
\question{Explain the difference between linearizability and sequential consistency.}

\points{15}
\question{Describe an algorithm that computes a spanning tree of a network $G(V,E)$. Explain how a node of the network can use the existence of such a spanning tree in order to broadcast information to all nodes of the network.}

\points{15}
\question{Describe the two generals problem. Can you find a solution to the problem? If yes describe your solution and provide a proof of its time and communication complexity. If not provide a proof that the problem is not solvable. }
%Nämn både synchronous och asynchronous system!

\points{10}
\question{Gifford's quorum consensus replication is in use at servers $X, Y$, and $Z$ which all hold replica's of data items $A$ and $B$. The initial values of all replicas of $A$ and $B$ are 100 and the votes for $A$ an $B$ are 1 at each $X, Y$ and $Z$. Also $R=W=2$ for both $A$ and $B$. A client reads the value of $A$ then writes it to $B$.}\\
\question[a]{At the time the client performs these operations, a particion separates server $X$ and $Y$ from server $Z$. Describe the quota obtained and the operations that take place if the client can access server $X$ and $Y$.}
\question[b]{Describe the quora obtained and the operations that take place if the client can access only server $Z$.}
\question[c]{The partition is repaired and then another partition occurs so that $X$ and $Z$ are separated from $Y$. Describe the quora obtained and the operations that take place if the client can access server $X$ and $Z$.}
\end{document}
